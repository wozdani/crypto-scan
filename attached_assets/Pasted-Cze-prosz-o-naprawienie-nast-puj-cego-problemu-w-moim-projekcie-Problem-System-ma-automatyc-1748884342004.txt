CzeÅ›Ä‡, proszÄ™ o naprawienie nastÄ™pujÄ…cego problemu w moim projekcie:

ğŸ›  Problem
System ma automatycznie pobieraÄ‡ dane kontraktÃ³w tokenÃ³w z CoinGecko (gdy nie istniejÄ… w token_contract_map.json), ale:

kontrakty nie sÄ… pobierane i zapisywane mimo poprawnego formatu tokena,

plik token_contract_map.json nie aktualizuje siÄ™,

tokeny takie jak 1000000CHEEMSUSDT ciÄ…gle pokazujÄ… âš ï¸ Brak mapowania.

âœ… Oczekiwane dziaÅ‚anie
Gdy token nie istnieje w token_contract_map.json, funkcja get_token_contract_from_coingecko() ma pobieraÄ‡ kontrakt z CoinGecko.

Po pobraniu, kontrakt i chain majÄ… byÄ‡ dodane do token_contract_map.json (np. "1000000CHEEMSUSDT": {"address": "...", "chain": "bsc"}).

JeÅ›li nie da siÄ™ pobraÄ‡ â€“ zapisz symbol do missing_contracts_log.txt.

ğŸ” Co sprawdziÄ‡ / naprawiÄ‡
Czy import get_token_contract_from_coingecko jest poprawny:

python
Kopiuj
Edytuj
from utils.contracts import get_token_contract_from_coingecko
Czy w detect_whale_tx() (lub podobnym) znajduje siÄ™:

python
Kopiuj
Edytuj
if not token_info:
    clean_symbol = normalize_token_name(symbol)
    token_info = get_token_contract_from_coingecko(clean_symbol)
    if token_info:
        token_map[symbol] = token_info
        with open("token_contract_map.json", "w", encoding="utf-8") as f:
            json.dump(token_map, f, indent=2)
    else:
        # log missing
        with open("missing_contracts_log.txt", "a", encoding="utf-8") as f:
            f.write(f"{symbol}\n")
        return False
Czy plik token_contract_map.json istnieje i ma poprawne kodowanie utf-8?

Czy funkcja normalize_token_name(symbol) istnieje i oczyszcza token z prefiksÃ³w jak 1000000, USDT, PERP itp.?

Czy w utils/contracts.py znajduje siÄ™ poprawna funkcja:

python
Kopiuj
Edytuj
def get_token_contract_from_coingecko(symbol):
    try:
        url = f"https://api.coingecko.com/api/v3/search?query={symbol}"
        response = requests.get(url, timeout=10)
        data = response.json()
        coins = data.get("coins", [])

        for coin in coins:
            if symbol.lower() in coin["symbol"].lower():
                platform_data = coin.get("platforms", {})
                for chain, address in platform_data.items():
                    if address:
                        return {"address": address, "chain": chain.lower()}
        return None
    except Exception as e:
        print(f"âŒ BÅ‚Ä…d pobierania z CoinGecko: {e}")
        return None
ProszÄ™ o naprawÄ™ caÅ‚ego flow i sprawdzenie, czy tokeny bez kontraktÃ³w sÄ… poprawnie pobierane i dodawane do mapy. DziÄ™kujÄ™!

