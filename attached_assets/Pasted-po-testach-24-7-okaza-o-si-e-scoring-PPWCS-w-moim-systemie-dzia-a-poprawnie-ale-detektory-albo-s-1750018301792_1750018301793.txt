po testach 24/7 okazaÅ‚o siÄ™, Å¼e scoring PPWCS w moim systemie dziaÅ‚a poprawnie, ale detektory albo siÄ™ nie aktywujÄ…, albo logika jest zbyt rygorystyczna. ProszÄ™ o wdroÅ¼enie poniÅ¼szych poprawek detektorÃ³w i brakujÄ…cych funkcji.

ðŸ§© 1. Naprawa detect_volume_spike()
Aktualnie:

bazuje na volume_24h > market_cap * 0.1 â€” co jest zbyt ogÃ³lne i maÅ‚o precyzyjne.

ZamieÅ„ na:

python
Kopiuj
Edytuj
recent_volumes = data.get("recent_volumes", [])
if len(recent_volumes) >= 4:
    avg = sum(recent_volumes[-4:]) / 4
    current = recent_volumes[-1]
    if current > avg * 2.5:
        signals["volume_spike"] = True
ðŸ“‰ 2. ZÅ‚agodzenie detect_vwap_pinning()
Obecnie:

python
Kopiuj
Edytuj
avg_deviation < 0.004  # czyli < 0.4%
âž¡ï¸ To za maÅ‚o â€“ nie aktywuje siÄ™ prawie nigdy.

ZamieÅ„ na skalowanie:

python
Kopiuj
Edytuj
if avg_deviation < 0.005:
    return True, 1.0
elif avg_deviation < 0.008:
    return True, 0.7
elif avg_deviation < 0.012:
    return True, 0.4
else:
    return False, 0.0
ðŸ§  3. Dodanie brakujÄ…cych detektorÃ³w: stealth_acc i RSI_flatline
Obecnie: funkcje te sÄ… uÅ¼ywane w signals, ale nie istniejÄ… nigdzie w kodzie â€“ przez co ich wynik zawsze jest False.

Dodaj nowy plik utils/custom_detectors.py z:

python
Kopiuj
Edytuj
def detect_stealth_acc(signals):
    if (
        signals.get("whale_activity") and
        signals.get("dex_inflow") and
        not signals.get("social_spike")
    ):
        return True
    return False

def detect_rsi_flatline(rsi_value, signals):
    if 45 <= rsi_value <= 55:
        if signals.get("dex_inflow") or signals.get("whale_activity"):
            return True
    return False
I dopisz w scan_cycle() lub detect_stage_minus2_1():

python
Kopiuj
Edytuj
from utils.custom_detectors import detect_stealth_acc, detect_rsi_flatline

signals["stealth_acc"] = detect_stealth_acc(signals)
signals["RSI_flatline"] = detect_rsi_flatline(rsi_value, signals)  # rsi_value to RSI z ostatniej Å›wiecy
ðŸ—‚ 4. Detektor stage_minus2_2() uÅ¼ywa losowoÅ›ci
python
Kopiuj
Edytuj
random.seed(hash(symbol))
if random.random() > 0.7:
    event_tags.append("pattern")
ZamieÅ„ to na analizÄ™ realnych danych lub usuÅ„ tymczasowo, bo wprowadza szum i faÅ‚szywe tagi do PPWCS.

âœ… BONUS: dodaj logi debug w compute_ppwcs()
ProszÄ™ dodaÄ‡:

python
Kopiuj
Edytuj
print(f"[PPWCS DEBUG] Active detectors: {active_list}")
print(f"[PPWCS DEBUG] Stage -2.1 score: {stage_minus2_1_score}")
if signals.get("stage1g_active"):
    print(f"[PPWCS DEBUG] Stage 1g score: {stage1g_score}")
if tag and isinstance(tag, str):
    print(f"[PPWCS DEBUG] Event tag: {tag} â†’ {tag_scores.get(tag.lower(), 0)}")
