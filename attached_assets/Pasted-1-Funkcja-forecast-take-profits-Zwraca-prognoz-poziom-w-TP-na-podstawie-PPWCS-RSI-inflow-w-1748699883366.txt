1. Funkcja forecast_take_profits()
ğŸ”§ Zwraca prognozÄ™ poziomÃ³w TP na podstawie PPWCS, RSI, inflow, whale activity i struktury.

Wklej do gÅ‚Ã³wnego pliku lub np. forecast.py:

python
Kopiuj
Edytuj
def forecast_take_profits(symbol, data):
    ppwcs = data.get("ppwcs_score", 0)
    rsi = data.get("rsi", 50)
    whale = data.get("whale_activity", False)
    inflow = data.get("dex_inflow_usd", 0)
    compressed = data.get("compressed", False)
    stage1g = data.get("stage1g_active", False)
    pure_acc = data.get("pure_accumulation", False)

    # Bazowe poziomy TP
    tp1 = 0.06
    tp2 = 0.14
    tp3 = 0.27
    trailing_tp = "adaptive"

    # Wzmocnienie TP jeÅ›li sygnaÅ‚ bardzo silny
    if ppwcs >= 85 and compressed and stage1g:
        tp1 += 0.02
        tp2 += 0.04
        tp3 += 0.08
        trailing_tp = "aggressive trail"

    # Korekta TP3 przy wysokim RSI (wyczerpane momentum)
    if rsi > 70:
        tp3 -= 0.04
        trailing_tp = "early lock"

    # Boost za whales + inflow
    if whale and inflow > 100_000:
        tp3 += 0.05
        trailing_tp = "trail after TP2"

    # Boost za cichÄ… akumulacjÄ™
    if pure_acc:
        tp1 += 0.01
        tp2 += 0.02

    return {
        "TP1": round(tp1, 2),
        "TP2": round(tp2, 2),
        "TP3": round(tp3, 2),
        "trailing_tp": trailing_tp
    }
âœ… 2. Miejsce wywoÅ‚ania w scan_cycle()
ğŸ”§ Po obliczeniu PPWCS i przed send_alert() dodaj wywoÅ‚anie forecastu:

python
Kopiuj
Edytuj
tp_forecast = forecast_take_profits(symbol, data)
send_alert(symbol, ppwcs_score, alert_level, tp_forecast=tp_forecast)
âœ… 3. Modyfikacja send_alert()
ğŸ”§ Dodaj obsÅ‚ugÄ™ TP w treÅ›ci wiadomoÅ›ci Telegram:

python
Kopiuj
Edytuj
def send_alert(symbol, ppwcs_score, alert_level, tp_forecast=None):
    message = f"ğŸš¨ {alert_level} Alert: ${symbol.upper()}\n\n"
    message += f"PPWCS: {ppwcs_score}\n"

    if tp_forecast:
        message += "\nğŸ“Š Take Profit Forecast:\n"
        message += f"â€¢ TP1: +{int(tp_forecast['TP1'] * 100)}%\n"
        message += f"â€¢ TP2: +{int(tp_forecast['TP2'] * 100)}%\n"
        message += f"â€¢ TP3: +{int(tp_forecast['TP3'] * 100)}%\n"
        message += f"â€¢ Trailing TP: {tp_forecast['trailing_tp']}\n"

    message += f"\nâ± Detected at: {datetime.utcnow().strftime('%H:%M UTC')}"
    send_telegram_message(message)
