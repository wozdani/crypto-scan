CzeÅ›Ä‡,

PotrzebujÄ™ wdroÅ¼yÄ‡ nowÄ… funkcjÄ™ detect_stage_minus1(data) dla strategii trend mode, ktÃ³ra nie uÅ¼ywa scoringu, technicznych warunkÃ³w ani Å¼adnych wskaÅºnikÃ³w (EMA, RSI, whales, pre-pumpy).

ğŸ¯ Cel:
Funkcja ma wykrywaÄ‡ moment napiÄ™cia w rynku:

Trend wzrostowy trwa, ale pauzuje bez cofniÄ™cia,

Åšwiece sÄ… spÃ³jne rytmicznie, bez paniki,

Rynek wyglÄ…da, jakby czekaÅ‚ na kontynuacjÄ™, a nie na wybicie z doÅ‚ka.

âœ… Gotowy kod do wdroÅ¼enia:
python
Kopiuj
Edytuj
def detect_stage_minus1(data):
    \"\"\"
    Stage â€“1 (Trend Mode) â€“ oparty na rytmie i napiÄ™ciu rynku.
    Nie stosuje scoringu. DziaÅ‚a na zasadzie 'czy rynek trzyma oddech'.
    \"\"\"
    if len(data) < 6:
        return False, \"Za maÅ‚o Å›wiec do analizy rytmu\"

    def body(c): return abs(c[4] - c[1])
    def wick_down(c): return c[1] - c[3]
    def total_range(c): return c[2] - c[3]

    last = data[-1]
    prev = data[-2]
    three_back = data[-4]

    # 1. Czy rynek zatrzymaÅ‚ siÄ™, ale nie odwrÃ³ciÅ‚?
    if last[4] < three_back[4]:
        return False, \"Cena cofnÄ™Å‚a siÄ™ za gÅ‚Ä™boko wzglÄ™dem poprzedniego impulsu\"

    # 2. Czy Å›wieca wyglÄ…da na spokojnÄ…, bez paniki?
    if last[4] < last[1]:  # Å›wieca czerwona
        wick_ratio = wick_down(last) / total_range(last) if total_range(last) else 0
        if wick_ratio < 0.2:
            return False, \"Korekta bez odbicia â€“ moÅ¼liwa panika\"

    # 3. Czy rytm Å›wiec jest spÃ³jny?
    body_now = body(last)
    body_prev = body(three_back)
    if body_now == 0 or body_prev == 0:
        return False, \"Brak wyraÅºnych ciaÅ‚ Å›wiec\"

    similarity = min(body_now, body_prev) / max(body_now, body_prev)
    if similarity < 0.6:
        return False, \"Zaburzony rytm ciaÅ‚ Å›wiec â€“ brak harmonii\"

    # 4. Czy trend nie zostaÅ‚ zniszczony? (close[-1] > close[-4])
    if last[4] < data[-4][4]:
        return False, \"Trend siÄ™ zaÅ‚amaÅ‚ â€“ kierunek nieutrzymany\"

    # âœ… Wszystko wyglÄ…da jak zatrzymanie, nie odwrÃ³t
    return True, \"Ruch wstrzymany, rytm utrzymany, brak paniki â€“ moÅ¼liwe wybicie\"
ğŸ”„ Integracja:
Funkcja powinna byÄ‡ wywoÅ‚ywana w detect_trend_mode(symbol)
JeÅ›li zwraca True, dopiero wtedy uruchamiane:

python
Kopiuj
Edytuj
detect_orderbook_sentiment(symbol)
DziÄ™ki! Dajcie znaÄ‡, jeÅ›li potrzebny bÄ™dzie kolejny krok do peÅ‚nego pipeline'u trend_entry.
To bÄ™dzie podstawa intuicyjnego, rytmicznego systemu trendowego.

Pozdrawiam,
Szefir